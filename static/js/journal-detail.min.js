let currentPublicationsPage=1,totalPublicationsPages=1;const publicationsPerPage=25;function initializePagination(){const e=getVenueDataFromPage();if(e){if(e.totalPublications&&e.totalPublications>25){totalPublicationsPages=Math.ceil(e.totalPublications/25),updatePublicationsPagination();const t=document.getElementById("prev-publications"),a=document.getElementById("next-publications");t&&t.addEventListener("click",loadPreviousPublications),a&&a.addEventListener("click",loadNextPublications)}}else console.warn("No venue data available")}function getVenueDataFromPage(){const e=document.getElementById("venue-data");return e?{venueId:e.dataset.venueId,publicationsLoaded:parseInt(e.dataset.publicationsLoaded)||0,totalPublications:parseInt(e.dataset.totalPublications)||0}:null}async function loadVenueDetails(){const e=getVenueDataFromPage();if(e&&e.venueId)try{const t=await fetch(`/api/v1/venues/${e.venueId}`),a=await t.json();if(404===t.status)return void(document.getElementById("venue-details").innerHTML='<p class="field-value">Periódico não encontrado.</p>');document.querySelector(".page-title").textContent=a.venue_name||"Periódico";let n='<table class="data-table item-detail-table"><tbody>';n+=`<tr><th scope="row">NOME</th><td class="field-value">${a.venue_name||"N/A"}</td></tr>`,n+=`<tr><th scope="row">TIPO</th><td class="field-value">${a.venue_type||"N/A"}</td></tr>`;n+=`<tr><th scope="row">ISSN</th><td class="field-value">${a.issn_linking||a.issn_print||a.issn_electronic||"N/A"}</td></tr>`,n+=`<tr><th scope="row">EDITORA</th><td class="field-value">${a.publisher_name||"N/A"}</td></tr>`,a.established_year&&(n+=`<tr><th scope="row">ANO DE FUNDAÇÃO</th><td class="field-value">${a.established_year}</td></tr>`),n+=`<tr><th scope="row">IDIOMA</th><td class="field-value">${a.language||"N/A"}</td></tr>`,n+=`<tr><th scope="row">TOTAL DE PUBLICAÇÕES</th><td class="field-value">${a.total_publications||0}</td></tr>`,a.start_year&&a.end_year&&a.start_year!==a.end_year&&(n+=`<tr><th scope="row">PERÍODO</th><td class="field-value">${a.start_year} - ${a.end_year}</td></tr>`),n+="</tbody></table>",document.getElementById("venue-details").innerHTML=n}catch(e){console.error("Error loading venue details:",e),document.getElementById("venue-details").innerHTML='<p class="field-value">Erro ao carregar detalhes do periódico.</p>'}else console.error("No venue ID available")}async function loadVenuePublications(e=1){const t=getVenueDataFromPage();if(t&&t.venueId)try{const a=25*(e-1),n=await fetch(`/api/v1/venues/${t.venueId}/publications?limit=25&offset=${a}`),i=await n.json(),o=document.getElementById("venue-publications");if(0===i.results.length)return void(o.innerHTML='<p class="field-value">Nenhuma publicação encontrada neste periódico.</p>');let l='<table class="data-table venue-publications-table" aria-describedby="venue-publications-title">';l+="<thead><tr>",l+='<th scope="col">TÍTULO</th>',l+='<th scope="col">AUTOR(ES)</th>',l+='<th scope="col">TIPO</th>',l+='<th scope="col">ANO</th>',l+="</tr></thead><tbody>",i.results.forEach(e=>{l+="<tr>",l+=`<td class="field-value"><a class="action-link" href="/work/${e.id}" aria-label="Ver detalhes de ${e.title}">${e.title}</a></td>`,l+=`<td class="field-value">${e.authors||"Não informado"}</td>`,l+=`<td class="result-type">${e.type||"N/A"}</td>`,l+=`<td class="field-value">${e.publication_year||"N/A"}</td>`,l+="</tr>"}),l+="</tbody></table>",o.innerHTML=l,currentPublicationsPage=e,totalPublicationsPages=Math.ceil(i.total/25),updatePublicationsPagination()}catch(e){console.error("Error loading venue publications:",e),document.getElementById("venue-publications").innerHTML='<p class="field-value">Erro ao carregar publicações.</p>'}else console.error("No venue ID available for publications")}function updatePublicationsPagination(){const e=document.getElementById("publications-pagination"),t=document.getElementById("publications-page-info"),a=document.getElementById("prev-publications"),n=document.getElementById("next-publications");totalPublicationsPages>1?(e.classList.remove("hidden"),t.textContent=`Página ${currentPublicationsPage} de ${totalPublicationsPages}`,1===currentPublicationsPage?(a.disabled=!0,a.className="action-btn pagination-btn"):(a.disabled=!1,a.className="action-btn btn-negative"),currentPublicationsPage===totalPublicationsPages?(n.disabled=!0,n.className="action-btn pagination-btn"):(n.disabled=!1,n.className="action-btn btn-positive")):e.classList.add("hidden")}function loadPreviousPublications(){currentPublicationsPage>1&&loadVenuePublications(currentPublicationsPage-1)}function loadNextPublications(){currentPublicationsPage<totalPublicationsPages&&loadVenuePublications(currentPublicationsPage+1)}document.addEventListener("DOMContentLoaded",function(){const e=getVenueDataFromPage();e&&e.venueId?(initializePagination(),document.querySelector(".page-title").textContent.trim()||loadVenueDetails(),loadVenuePublications()):console.warn("No venue ID provided")}),window.loadPreviousPublications=loadPreviousPublications,window.loadNextPublications=loadNextPublications;