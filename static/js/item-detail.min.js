function initializeItemActions(){const t=document.getElementById("add-to-list-btn"),e=document.getElementById("share-btn"),o=document.getElementById("print-btn");t&&(t.addEventListener("click",handleAddToList),setTimeout(checkIfItemInList,100)),e&&e.addEventListener("click",handleShare),o&&o.addEventListener("click",handlePrint)}function handleShare(){const t=document.getElementById("share-btn").dataset.title||document.title,e=window.location.href;navigator.share?navigator.share({title:t,url:e}).catch(t=>{console.warn("Sharing cancelled or failed:",t),fallbackCopyToClipboard(e)}):fallbackCopyToClipboard(e)}function fallbackCopyToClipboard(t){if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(t).then(()=>{showNotification("Link copiado para a área de transferência")}).catch(()=>{showNotification("Erro ao copiar link")});else{const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select();try{document.execCommand("copy"),showNotification("Link copiado para a área de transferência")}catch(t){showNotification("Erro ao copiar link")}document.body.removeChild(e)}}function handlePrint(){window.print()}function handleAddToList(){const t=extractItemDataFromPage();if(!t)return void showNotification("Erro ao obter dados do item","error");if(!window.MyList||!window.MyList.addToPersonalList)return void showNotification("Módulo de lista não disponível. Recarregue a página","error");const e=window.MyList.addToPersonalList(t);e.success?(showAddToListSuccess(e.message),updateAddToListButton(!0)):showNotification(e.message,e.success?"success":"error")}function extractItemDataFromPage(){try{const t=document.querySelector(".page-title"),e=t?t.textContent.trim():null;if(!e)return null;const o=window.location.pathname.split("/"),n=o[o.length-1];if(!n||isNaN(parseInt(n)))return null;let i=null,a=null,r=null,s=null;const c=document.querySelectorAll("table tr");for(const t of c){const e=t.querySelector("th"),o=t.querySelector("td");if(!e||!o)continue;switch(e.textContent.trim()){case"AUTOR(ES)":const t=o.querySelectorAll("a.action-link");if(t.length>0)i=Array.from(t).map(t=>({full_name:t.textContent.trim()}));else{const t=o.textContent.trim();t&&"Não informado"!==t&&(i=t)}break;case"ANO":const e=o.textContent.trim();e&&"N/A"!==e&&(a=parseInt(e)||e);break;case"PERIÓDICO":const n=o.querySelector("a.action-link");if(n)r=n.textContent.trim();else{const t=o.textContent.trim();t&&"N/A"!==t&&(r=t)}break;case"TIPO":const c=o.textContent.trim();c&&"N/A"!==c&&(s=c)}}return{id:parseInt(n),title:e,authors:i,publication_year:a,venue_name:r,type:s}}catch(t){return console.error("Error extracting item data:",t),null}}function showAddToListSuccess(t){showNotification(t,"success")}function showNotification(t,e="info"){const o=document.createElement("div");o.className=`notification notification-${e}`,o.textContent=t,o.setAttribute("role","status"),o.setAttribute("aria-live","polite"),Object.assign(o.style,{position:"fixed",top:"20px",right:"20px",background:"success"===e?"var(--primary-blue)":"var(--subtle-gray)",color:"white",padding:"var(--spacing-sm) var(--spacing-md)",borderRadius:"4px",zIndex:"1000",fontFamily:"var(--mono)",fontSize:"12px",maxWidth:"300px"}),document.body.appendChild(o),setTimeout(()=>{o.parentNode&&(o.style.opacity="0",o.style.transition="opacity 0.3s ease-out",setTimeout(()=>{o.parentNode&&o.parentNode.removeChild(o)},300))},3e3)}function updateAddToListButton(t){const e=document.getElementById("add-to-list-btn");e&&t&&(e.textContent="Adicionado à Lista",e.disabled=!0,e.setAttribute("aria-label","Item já adicionado à lista pessoal"))}function checkIfItemInList(){if(!window.MyList||!window.MyList.getPersonalList)return;const t=window.location.pathname.split("/"),e=parseInt(t[t.length-1]);if(!e||isNaN(e))return;window.MyList.getPersonalList().some(t=>t.id===e)&&updateAddToListButton(!0)}document.addEventListener("DOMContentLoaded",function(){initializeItemActions()});